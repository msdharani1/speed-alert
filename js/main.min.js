document.addEventListener('DOMContentLoaded', function() {
	const speedElement = document.getElementById('speedValue');
	let qrCodeValue = 50; // Default speed limit
	let lastPosition = null;

	function playSound() {
	  // code to play the sound
	  const audio = new Audio("sound.mp3");
	  audio.play();
	}

	function updateSpeed(speed) {
	  speedElement.textContent = speed.toFixed(0);
	  if (qrCodeValue < 20) {
		playSound();
	  }
	}

	function scanQRCode() {
		const scanner = new Instascan.Scanner({
		  video: document.getElementById('preview')
		});
	  
		scanner.addListener('scan', function(content) {
		  alert('scanned: ' + content);
		  qrCodeValue = parseFloat(content) || 0;
		});
	  
		Instascan.Camera.getCameras().then(function(cameras) {
		  if (cameras.length > 0) {
			scanner.start(cameras[0]);
		  } else {
			console.error('No camera found');
		  }
		}).catch(function(e) {
		  console.error(e);
		});
	  }
	  

	// Call scanQRCode outside the event listener
	scanQRCode();

	// update speed
	setInterval(function() {
	  if (navigator.geolocation) {
		navigator.geolocation.getCurrentPosition(function(position) {
		  // The speed property is in meters per second, convert it to km/h
		  const speed = position.coords.speed * 3.6 || 0;
		  updateSpeed(speed);
		}, function(error) {
		  console.error('Error getting speed error');
		  speedElement.textContent = 'N/A';
		});
	  } else {
		console.error('Geolocation is not supported');
		speedElement.textContent = 'N/A';
	  }
	}, 1000);
  });

  // modal - popup box
  function show() {
	var shows = document.getElementById('dis');
	shows.style.display = 'block';
  }

  function hide() {
	var hides = document.getElementById('dis');
	hides.style.display = 'none';
  }